---
title: "Análisis de diversidad de especies en sitios simulados"
author: "Adriana Melissa Martínez Rojas, Alondra Michelle, Isabel"
date: "2025-03-09"
output: html_document
---

## **Introducción**

## **Objetivos**

-   Analizar la estructura de las comunidades con gráficos de abundancias ordenadas.

-   Comparar la diversidad entre sitios utilizando medidas de diversidad beta.

-   Medir la diversidad alfa con los índices Shannon, Pielou, Simpson, Simpson inverso, Gini, y Chao1.

-   Encontrar la curva de rarefacción para cada sitio.

-   Calcular la gráfica de abundancias-ordenadas (rank-abundance) para cada sitio.

-   Calcular la diversidad beta de todos las parejas de sitios utilizando los índices de: Jaccard y Bray-Curtis.

-   Construir una matriz de diferencias (distancias) para cada medida.

## **Resultados**

### Bolsa estrella:

### 

```{r message=FALSE, warning=FALSE}
abundancias_estrella_BD <- data.frame( 
  especie = c("azul oscuro", "verde claro", "verde menta", "azul claro", 
              "azul cielo", "rosa mexicano", "amarillo", "rosa claro", "naranja",
              "rojo", "rosa", "morado"),
  numero_de_individuos = c(17, 15, 10, 4, 4, 3, 3, 2, 2, 1, 1, 1)
)

abundancias_estrella <- c(17, 15, 10, 4, 4, 3, 3, 2, 2, 1, 1, 1)

library(ggplot2)

ggplot(abundancias_estrella_BD, aes(x = reorder(especie, -numero_de_individuos), 
                                 y = numero_de_individuos, 
                                 fill = especie)) +
  geom_bar(stat = "identity") +
  labs(title = "Abundancia de especies de la bolsa estrella",
       x = "Especies",
       y = "Número de individuos") +
  scale_fill_manual(values = c(
    "azul oscuro" = "darkblue",
    "verde claro" = "lightgreen",
    "verde menta" = "mediumspringgreen",
    "azul claro" = "lightblue",
    "azul cielo" = "skyblue",
    "rosa mexicano" = "deeppink",
    "amarillo" = "yellow",
    "rosa claro" = "lightpink",
    "naranja" = "orange",
    "rojo" = "red",
    "rosa" = "hotpink",
    "morado" = "purple"
  )) +
  theme(axis.text.x = element_text(angle = 90))
```

### *Índices*

**Shannon**

```{r}
source("FUNCIONES.R")
E_shannon <- shannon_mejor(abundancias_estrella)
print(E_shannon)
```

### 

**Pielou**

```{r}
E_pielou <- pielou(abundancias_estrella)
print(E_pielou)
```

### 

**Simpson**

```{r}
E_simpson <- simpson_funcion(abundancias_estrella)
print(E_simpson)
```

### 

**Simpson inverso**

```{r}
E_inverso <- inverso_simpson(abundancias_estrella)
print(E_inverso)
```

### Bolsa corazón:

### 

```{r message=FALSE, warning=FALSE}
abundancias_corazon_BD <- data.frame( 
  especie = c("azul oscuro", "rosa mexicano", "amarillo", "rosa claro", "naranja",
              "rojo", "rosa", "morado"),
  numero_de_individuos = c(6, 2, 1, 7, 8, 1, 6, 9)
)

abundancias_corazon <- c(6, 2, 1, 7, 8, 1, 6, 9)

ggplot(abundancias_corazon_BD, aes(x = reorder(especie, -numero_de_individuos), 
                                    y = numero_de_individuos, 
                                    fill = especie)) +
  geom_bar(stat = "identity") +
  labs(title = "Abundancia de especies de la bolsa corazon",
       x = "Especies",
       y = "Número de individuos") +
  scale_fill_manual(values = c(
    "azul oscuro" = "darkblue",
    "rosa mexicano" = "deeppink",
    "amarillo" = "yellow",
    "rosa claro" = "lightpink",
    "naranja" = "orange",
    "rojo" = "red",
    "rosa" = "hotpink",
    "morado" = "purple"
  )) +
  theme(axis.text.x = element_text(angle = 90))
```

### 

### *Índices*

**Shannon**

```{r}
C_shannon <- shannon_mejor(abundancias_corazon)
print(C_shannon)
```

### 

**Pielou**

```{r}
C_pielou <- pielou(abundancias_corazon)
print(C_pielou)
```

### 

**Simpson**

```{r}
C_simpson <- simpson_funcion(abundancias_corazon)
print(C_simpson)
```

### 

**Simpson inverso**

```{r}
C_inverso <- inverso_simpson(abundancias_corazon)
print(C_inverso)
```

#### **Bolsa sonrisa**

```{r}
sonrisa_abundancias <- c(1,2,2,3,3,4,4,5,5,5,7,9)
sonrisa_conjunto<- c("rosa claro", "rosa", "morado", "rosa mexicano", "azul claro","verde claro","amarillo", 
                     "azul cielo","rojo","naranja", "azul oscuro", "verde menta")

names(sonrisa_abundancias)<- sonrisa_conjunto
print(sonrisa_abundancias)

#data frame
sonrisa_dataframe <- data.frame(
  especie_color = sonrisa_conjunto,
  abundancia = sonrisa_abundancias
)
print (sonrisa_dataframe)
```

**gráfica con ggplot**

```{r}
G_sonrisa <- ggplot (sonrisa_dataframe, aes(x=especie_color, y= abundancia, fill = especie_color))+  
  geom_bar(stat = "identity") +
  labs(title = "Abundancia de especies en la bolsa sonrisa",
       x = "Especies",
       y = "Número de individuos") +
  scale_fill_manual(values = c(
    "azul oscuro" = "darkblue",
    "verde claro" = "lightgreen",
    "verde menta" = "mediumspringgreen",
    "azul claro" = "lightblue",
    "azul cielo" = "skyblue",
    "rosa mexicano" = "deeppink",
    "amarillo" = "yellow",
    "rosa claro" = "lightpink",
    "naranja" = "orange",
    "rojo" = "red",
    "rosa" = "hotpink",
    "morado" = "purple"
  ))
print (G_sonrisa)
```

### *Indices*

**shanon**

```{r}
shannon_mejor(sonrisa_abundancias)-> shannon_sonrisa
print(shannon_sonrisa)
#3.39
```

**pielou**

```{r}
pielou(sonrisa_abundancias)-> pielou_sonrisa
print(pielou_sonrisa)
#1.36
```

**simpson**

```{r}
simpson_funcion(sonrisa_abundancias)-> simpson_sonrisa
print(simpson_sonrisa)
#0.10
```

**simpson inverso**

```{r}
inverso_simpson(sonrisa_abundancias)-> inverso_sonrisa
print(inverso_sonrisa)
#9.46
```

**gini**

```{r}
Gini(sonrisa_abundancias)-> gini_sonrisa
print(gini_sonrisa)
#0.30
```

**chao**

```{r}
estimateR(sonrisa_abundancias)
#12
```

## **Discusión**

## **Cuestionario**

**1. ¿Cómo varían los valores de los índices entre los sitios? ¿Qué diferencias resaltan?**

**2. ¿Cuál índice es más sensible a especies raras?**

**3. ¿Por qué el índice de Pielou nos da información sobre la equitatividad de la comunidad?**

**4. ¿Cuál sitio parece tener mayor diversidad según la curva de rarefacción? ¿Por qué?**

**5. ¿Cómo afecta el tamaño de la muestra en la forma de la curva?**

**6. ¿Cuál de estos índices es más sensible a la diferencia en abundancias?**

**7. ¿Qué interpretación ecológica tienen las diferencias entre sitios?**

**8. ¿Cómo interpretas la forma de las curvas de abundancia?**

**9. ¿Qué implicaciones tienen para la dominancia de especies?**

**10. ¿Qué patrones generales observaste en la diversidad entre los sitios?**

**11. ¿Cuál índice te pareció más útil y por qué?**
